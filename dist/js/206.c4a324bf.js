"use strict";(self["webpackChunkiris_vue3_project"]=self["webpackChunkiris_vue3_project"]||[]).push([[206],{9206:function(e,t,o){o.r(t),o.d(t,{default:function(){return I}});var a=o(3396),l=o(7139);const n={class:"text-end mt-4"},i={class:"table mt-4"},d=(0,a._)("thead",null,[(0,a._)("tr",null,[(0,a._)("th",null,"名稱"),(0,a._)("th",null,"折扣百分比"),(0,a._)("th",null,"到期日"),(0,a._)("th",null,"是否啟用"),(0,a._)("th",null,"編輯")])],-1),s={key:0,class:"text-success"},u={key:1,class:"text-muted"},p={class:"btn-group"},c=["onClick"],r=["onClick"];function h(e,t,o,h,m,_){const b=(0,a.up)("LoadingOverlay"),C=(0,a.up)("CuponModal"),f=(0,a.up)("DeleteModal");return(0,a.wg)(),(0,a.iD)("div",null,[(0,a.Wm)(b,{active:m.isLoading},null,8,["active"]),(0,a._)("div",n,[(0,a._)("button",{class:"btn btn-primary",onClick:t[0]||(t[0]=e=>_.openCuponModal(!0))}," 建立新的優惠券 ")]),(0,a._)("table",i,[d,(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(m.cuponList,(t=>((0,a.wg)(),(0,a.iD)("tr",{key:t.id},[(0,a._)("td",null,(0,l.zw)(t.title),1),(0,a._)("td",null,(0,l.zw)(t.percent)+"%",1),(0,a._)("td",null,(0,l.zw)(e.$filters.date(t.due_date)),1),(0,a._)("td",null,[1===t.is_enabled?((0,a.wg)(),(0,a.iD)("span",s,"啟用")):(0,a.kq)("",!0),0===t.is_enabled?((0,a.wg)(),(0,a.iD)("span",u,"未啟用")):(0,a.kq)("",!0)]),(0,a._)("td",null,[(0,a._)("div",p,[(0,a._)("button",{class:"btn btn-outline-primary btn-sm",onClick:e=>_.openCuponModal(!1,t)},"編輯",8,c),(0,a._)("button",{class:"btn btn-outline-danger btn-sm",onClick:e=>_.delCuponModal(t)},"刪除",8,r)])])])))),128))])]),(0,a.Wm)(C,{ref:"cuponModal",tempCupon:m.tempCupon,onUpdateCupon:_.updateCupon},null,8,["tempCupon","onUpdateCupon"]),(0,a.Wm)(f,{ref:"deleteModal","delete-item":m.tempCupon,onDeleteProduct:_.deleteCupon},null,8,["delete-item","onDeleteProduct"])])}var m=o(9242);const _={class:"modal fade",id:"cuponModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},b={class:"modal-dialog",role:"document"},C={class:"modal-content"},f=(0,a._)("div",{class:"modal-header"},[(0,a._)("h5",{class:"modal-title",id:"exampleModalLabel"},"優惠卷"),(0,a._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),v={class:"modal-body"},w={class:"mb-3"},D=(0,a._)("label",{for:"title"},"標題",-1),y={class:"mb-3"},g=(0,a._)("label",{for:"coupon_code"},"優惠碼",-1),M={class:"mb-3"},k=(0,a._)("label",{for:"due_date"},"到期日",-1),x={class:"mb-3"},$=(0,a._)("label",{for:"price"},"折扣百分比",-1),L={class:"mb-3"},U={class:"form-check"},V=(0,a._)("label",{class:"form-check-label",for:"is_enabled"}," 是否啟用 ",-1),j={class:"modal-footer"},N=(0,a._)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close",-1);function O(e,t,o,l,n,i){return(0,a.wg)(),(0,a.iD)("div",_,[(0,a._)("div",b,[(0,a._)("div",C,[f,(0,a._)("div",v,[(0,a._)("div",w,[D,(0,a.wy)((0,a._)("input",{type:"text",class:"form-control",id:"title","onUpdate:modelValue":t[0]||(t[0]=e=>n.cuponData.title=e),placeholder:"請輸入標題"},null,512),[[m.nr,n.cuponData.title]])]),(0,a._)("div",y,[g,(0,a.wy)((0,a._)("input",{type:"text",class:"form-control",id:"coupon_code","onUpdate:modelValue":t[1]||(t[1]=e=>n.cuponData.code=e),placeholder:"請輸入優惠碼"},null,512),[[m.nr,n.cuponData.code]])]),(0,a._)("div",M,[k,(0,a.wy)((0,a._)("input",{type:"date",class:"form-control",id:"due_date","onUpdate:modelValue":t[2]||(t[2]=e=>n.due_date=e)},null,512),[[m.nr,n.due_date]])]),(0,a._)("div",x,[$,(0,a.wy)((0,a._)("input",{type:"number",class:"form-control",id:"price","onUpdate:modelValue":t[3]||(t[3]=e=>n.cuponData.percent=e),placeholder:"請輸入折扣百分比"},null,512),[[m.nr,n.cuponData.percent,void 0,{number:!0}]])]),(0,a._)("div",L,[(0,a._)("div",U,[(0,a.wy)((0,a._)("input",{class:"form-check-input",type:"checkbox","true-value":1,"false-value":0,id:"is_enabled","onUpdate:modelValue":t[4]||(t[4]=e=>n.cuponData.is_enabled=e)},null,512),[[m.e8,n.cuponData.is_enabled]]),V])])]),(0,a._)("div",j,[N,(0,a._)("button",{type:"button",class:"btn btn-primary",onClick:t[5]||(t[5]=t=>e.$emit("update-cupon",n.cuponData))},"更新優惠券 ")])])])],512)}var Z=o(5741),z={props:{tempCupon:{type:Object,default(){return{}}}},data(){return{cuponData:{},due_date:""}},emits:["update-cupon"],watch:{tempCupon(){this.cuponData=this.tempCupon;const e=new Date(1e3*this.cuponData.due_date).toISOString().split("T");[this.due_date]=e},due_date(){this.cuponData.due_date=Math.floor(new Date(this.due_date)/1e3)}},mixins:[Z.Z]},W=o(89);const q=(0,W.Z)(z,[["render",O]]);var P=q,S=o(1364),T={components:{CuponModal:P,DeleteModal:S.Z},props:{config:Object},data(){return{cuponList:{},tempCupon:{title:"",is_enabled:0,percent:100,code:""},pagination:{},isLoading:!1,isNew:!1}},methods:{openCuponModal(e,t){this.isNew=e,this.isNew?this.tempCupon={due_date:(new Date).getTime()/1e3}:this.tempCupon={...t},this.$refs.cuponModal.showModal()},delCuponModal(e){this.tempCupon={...e},this.$refs.deleteModal.showModal()},getCupon(){const e="https://vue3-course-api.hexschool.io/api/iris-lai-api/admin/coupons";this.isLoading=!0,this.$http.get(e).then((e=>{this.cuponList=e.data.coupons,this.isLoading=!1}))},updateCupon(e){this.tempCupon=e;let t="https://vue3-course-api.hexschool.io/api/iris-lai-api/admin/coupon",o="post";this.isNew||(t=`https://vue3-course-api.hexschool.io/api/iris-lai-api/admin/coupon/${e.id}`,o="put"),this.$http[o](t,{data:this.tempCupon}).then((e=>{this.getCupon(),this.$refs.cuponModal.hideModal()}))},deleteCupon(){const e=`https://vue3-course-api.hexschool.io/api/iris-lai-api/admin/coupon/${this.tempCupon.id}`;this.$http.delete(e).then((e=>{this.getCupon(),this.$refs.deleteModal.hideModal()}))}},created(){this.getCupon()}};const H=(0,W.Z)(T,[["render",h]]);var I=H}}]);
//# sourceMappingURL=206.c4a324bf.js.map